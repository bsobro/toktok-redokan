jQuery(document).ready(function(e){var o={messages:{geocoder_failed:"Geocoder failed due to: ",no_address:"Please enter an address."},object_id:!1,ajax:{},init:function(){jQuery(".gmw-cl-form-trigger").click(function(e){e.preventDefault(),jQuery(this).closest(".gmw-cl-form-wrapper").find("form").slideToggle()}),jQuery(".gmw-cl-locator-trigger").click(function(e){e.preventDefault(),o.object_id=jQuery(this).closest("form").data("element-id"),jQuery(".gmw-cl-address-input").prop("readonly",!0),jQuery(".gmw-cl-form-submit").removeClass("gmw-icon-search").addClass("gmw-icon-spin-light animate-spin");var s=jQuery("#gmw-cl-message-"+o.object_id).data("loading_message");0!=s&&0!==s.length&&jQuery("#gmw-cl-respond-wrapper-"+o.object_id).slideDown("fast",function(){jQuery("#gmw-cl-message-"+o.object_id).addClass("locating").html(s)}),GMW.auto_locator("cl_locator",o.auto_locator_success,o.geocoder_failed)}),jQuery(".gmw-cl-address-input").bind("keypress",function(e){13==e.keyCode&&jQuery(this).closest("form").find(".gmw-cl-form-submit").click()}),jQuery(".gmw-cl-form-submit").click(function(e){if(e.preventDefault(),o.object_id=jQuery(this).closest("form").data("element-id"),0===jQuery("#gmw-cl-address-input-"+o.object_id).val().length)return alert(o.messages.no_address),!1;jQuery(".gmw-cl-address-input").prop("readonly",!0),jQuery(".gmw-cl-form-submit").removeClass("gmw-icon-search").addClass("gmw-icon-spin-light animate-spin");var s=jQuery("#gmw-cl-message-"+o.object_id).data("loading_message");0!=s&&0!==s.length&&jQuery("#gmw-cl-respond-wrapper-"+o.object_id).slideDown("fast",function(){jQuery("#gmw-cl-message-"+o.object_id).addClass("locating").html(s)});var r=jQuery("#gmw-cl-address-input-"+o.object_id).val();GMW.geocoder(r,o.address_geocoder_success,o.geocoder_failed)})},save_location:function(){o.ajax=jQuery.ajax({type:"POST",url:gmwAjaxUrl,dataType:"json",data:{action:"gmw_update_current_location",form_values:jQuery("#gmw-current-location-hidden-form").serialize(),security:gmw_cl_nonce},success:function(e){if("undefined"!=typeof GMW_Maps&&"undefined"!=typeof GMW_Maps[o.object_id]){var s=o.object_id,r=new google.maps.LatLng(e.lat,e.lng);GMW_Maps[s].user_marker.setPosition(r),GMW_Maps[s].map.panTo(r)}newAddress=jQuery("#gmw-cl-address-input-"+o.object_id).val(),jQuery(".gmw-cl-address .address-holder").html(newAddress)}}).fail(function(e){window.console&&window.console.log&&(e.responseText&&console.log(e.responseText),console.log(e))}),o.ajax.done(function(e){setTimeout(function(){jQuery(".gmw-cl-respond-wrapper").slideUp(),jQuery(".gmw-cl-address-input").prop("readonly",!1),jQuery(".gmw-cl-form-submit").removeClass("gmw-icon-spin-light animate-spin").addClass("gmw-icon-search")},500)})},submit_location:function(){setTimeout(function(){1==jQuery("#gmw-cl-form-wrapper-"+o.object_id).data("ajax_enabled")?o.save_location():jQuery("#gmw-current-location-hidden-form").submit()},3500)},auto_locator_success:function(e){jQuery("#gmw-cl-address-input-"+o.object_id).val(e.formatted_address),o.submit_location()},address_geocoder_success:function(e){GMW.save_location_fields(e),o.submit_location()},geocoder_failed:function(e){jQuery("#gmw-cl-respond-wrapper-"+o.object_id).slideDown(function(){jQuery("#gmw-cl-message-"+o.object_id).addClass("error").html(o.messages.geocoder_failed+e)}),setTimeout(function(){jQuery(".gmw-cl-respond-wrapper").slideUp(),jQuery(".gmw-cl-message").removeClass("error").html(""),jQuery(".gmw-cl-address-input").prop("readonly",!1),jQuery(".gmw-cl-form-submit").removeClass("gmw-icon-spin-light animate-spin").addClass("gmw-icon-search")},3e3)}};o.init()});